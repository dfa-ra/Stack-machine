
---

# Документация по Forth-подобному языку

## Основные секции программы

Программа делится на несколько секций. Каждая секция начинается с ключевого слова:

| Секция        | Назначение                           |
|---------------|--------------------------------------|
| `_import_`    | Импорт библиотек                     |
| `_data_`      | Объявление переменных                |
| `_func_`      | Определение пользовательских функций |
| `_text_`      | Тело основной программы              |

---

## Секция `_import_`

Используется для подключения внешних модулей (библиотек).
Библиотеки имеют собственное адресное пространство для переменных.
Библиотеки работают как inline всех библиотечных функций в блок `_func_` вашего файла  

### Пример:
```forth
_import_
    "../lib/num.forth"
    "../lib/str.forth"
```

---

## Секция `_data_`

Объявляет глобальные переменные с помощью ключевого слова `VAR`.

### Синтаксис:
```forth
<значение> VAR <имя>
```

Можно объявлять:
- Числа: `<число> VAR <переменная>`
- Массивы: `[<элементы массива>] <длинна массива> VAR <переменная>`
- Строки: `"<печатные символы>" VAR <переменная>`
- Буферы: `"" <число> VAR <переменная>` — строка длиной до 31 символа

### Пример:
```forth
_data_
    4 VAR len
    [0, 1, 2, 3] 4 VAR mas
    "What is your name?" VAR text
    "" 31 VAR buffer
```

---

## Секция `_func_`

Служит для определения новых слов (функций). Слово начинается с `:` и заканчивается на `;`.
Передача аргументов осуществляется через стек данных

### Синтаксис:

```forth
: имя_слова ... ;
```

### Пример:
```forth
_func_
: SUM
    + 
;
```


## Секция `_text_`

---
Содержит основное тело программы. 

## Основные команды и операции

### Работа с памятью

-



### Числа и арифметика

Поддерживаются:
- Десятичные числа: `123`, `-5`
- Шестнадцатеричные числа: `0x100`

Арифметические операции:
- Скалярные
  - `+` сложение
  - `-` вычитание
  - `*` умножение
  - `/` деление
  - `<<` сдвиг в лево
  - `>>` сдвиг в право
- Векторные
  - `v+` сложение
  - `v-` вычитание
  - `v*` умножение
  - `v/` деление
  - `v<<` сдвиг в лево
  - `v>>` сдвиг в право


---

###  Условия и логика

#### Конструкция `IF ... ELSE ... THEN`:
```forth
a b < IF
    a b + !a
ELSE
    a b + !b
THEN
```

---

### Циклы

#### Цикл `LOOP ... WHILE ... REPEAT`:
```forth
LOOP
    условие 
    WHILE
        тело
    REPEAT
```

#### Пример:
```forth
0 !i
LOOP
    i 10 < 1 
    WHILE
      count i * !count
    REPEAT
```

---

### Работа с регистрами и памятью
- Скаляр
  - `@` — загрузить значение по адресу в регистре `a`
  - `@+` — загрузить значение по адресу в регистре `a` и инкрементировать `a` 
  - `@b` — загрузить значение по адресу в регистре `b`
  - `!` — записать значение верха стека по адресу в регистре `a`
  - `!+` — записать значение верха стека по адресу в регистре `a` и инкрементировать `a`
  - `!b` — записать значение верха стека по адресу в регистре `b`
  - `a!` — загрузить верх стека в регистр `a`
  - `b!` — загрузить верх стека в регистр `b`
  - `!<переменная>` — записать значение верха стека в переменную
  - `&<переменная>` — положить на стек адрес переменной
  - `<переменная>` — положить на стек значение переменной
  - `<переменная?массив>` — положить на стек адрес массива
- Вектор
  - `v@` — загрузить вектор значение по адресу в регистре `a`
  - `v!` — записать значение с верха стека векторов значение по адресу в регистре `a`

#### Пример:
```forth
a tmp + a! @
```

---

###  Комментарии

Комментарии начинаются с символа `#` и продолжаются до конца строки:

```forth
# Это комментарий
5 5 +  # на стеке будет 10
```

---

### Завершение программы

Команда `HALT` завершает выполнение программы:

```forth
HALT
```
### Примеры

Примеры программ можно посмотреть вот [тут](../example)

